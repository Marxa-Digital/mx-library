<mat-drawer-container id="mx-navbar-container">

  <mat-drawer #sidebar position="end"
  [mxBackground]="backgroundColor" [mxColor]="fontColor"
  >
    <div class="container" id="mobile-menu">
      <div class="row">
        <div class="col s12" (click)="sidebar.toggle()">
          <button mat-icon-button>
            <mat-icon>close</mat-icon>
          </button>
        </div>
        <div class="col s12">
          <!-- LOGO -->
          <div class="logo-container" [routerLink]="['/']">
            <ng-container *ngIf="logo; else appTitle">
              <img [src]="logo" [alt]="title" />
            </ng-container>
            <ng-template #appTitle>
              {{title}}
            </ng-template>
          </div>

          <!-- BUSCADOR -->
          <div class="buscador-container" *ngIf="showSearcher">
            <span class="center"> {{searcherLabel}} </span>
            <mx-searcher
            [collection]="searchCollection"
            [selector]="searchSelector"
            [lengthTrigger]="searchTrigger"
            (selected)="onSearch.emit($event)"
            ></mx-searcher>
          </div>
        </div>
      </div>

      <mat-divider color="primary"></mat-divider>

      <!-- LOG ZONE -->
      <div *ngIf="showLogzone">
        <div class="col right user-profile" *ngIf="user; else unlogged">
          <div class="imgProfileContainer" [matMenuTriggerFor]="menuProfile">
            <img src="{{ user.photoURL }}" alt="image profile" />
          </div>

          <p class="userName">{{ user.displayName }}</p>
          <mat-menu #menuProfile="matMenu">
            <a mat-menu-item
              *ngFor="let item of userMenu"
              [routerLink]="[item.route]"
            >
              {{ item.name }}
            </a>

            <button mat-menu-item (click)="auth.singOut()">Cerrar sesión</button>
          </mat-menu>


        </div>

        <ng-template #unlogged>
          <ng-container *ngIf="loginMethod != 'link'; else emailMethod">
            <mx-login-button
            (isLogged)="user = $event"
            [method]="loginMethod"
            [accountAdvertice]="false"
            [signOutLabel]="logoutLabel"
            ></mx-login-button>
          </ng-container>
          <ng-template #emailMethod>
            <a [routerLink]="[loginButtonLink]" mat-raised-button>{{loginButtonLabel}}</a>
          </ng-template>
        </ng-template>
      </div>

      <div class="row" id="menus">

        <div class="col s12">
          <a [mxColor]="linkColor"
          class="topbar-item link"
          [routerLinkActive]="'active'"
          *ngFor="let item of menu"
          [routerLink]="[item.route]"
          >
            {{ item.name }}
        </a>
        </div>


      </div>
    </div>
  </mat-drawer>

  <mat-drawer-content>
    <mat-toolbar [mxColor]="fontColor" [mxBackground]="backgroundColor" id="navbar"
    class="mat-elevation-z5">

    <!-- LOGO -->
    <div class="logo-container" [routerLink]="['/']">
      <ng-container *ngIf="logo; else appTitle">
        <img [src]="logo" [alt]="title" />
      </ng-container>
      <ng-template #appTitle>
        {{title}}
      </ng-template>
    </div>
    <ng-container *ngIf="responsive.large; else mobile">

      <!-- BUSCADOR -->
      <div class="buscador-container" *ngIf="showSearcher" >
        <mx-searcher
        [collection]="searchCollection"
        [selector]="searchSelector"
        [lengthTrigger]="searchTrigger"
        (selected)="onSearch.emit($event)"
        ></mx-searcher>
      </div>

      <!-- MENÚ -->
      <div>

        <a mat-button
          [mxColor]="linkColor"
          class="topbar-item link"
          routerLinkActive
          #active="routerLinkActive"
          [ngStyle]="{
            'border-bottom': 'solid 1px '+linkColor,
            'color': activeLinkColor
          }"
          *ngFor="let item of menu"
          [routerLink]="[item.route]"
          >
            {{ item.name }}
        </a>
      </div>

      <!-- LOG ZONE -->
      <div *ngIf="showLogzone">
        <div class="col right user-profile" *ngIf="user; else unlogged">
          <div class="imgProfileContainer" [matMenuTriggerFor]="menuProfile">
            <img src="{{ user.photoURL }}" alt="image profile" />
          </div>

          <p class="userName">{{ user.displayName }}</p>
          <mat-menu #menuProfile="matMenu">
            <button
              mat-menu-item
              *ngFor="let item of menu"
              [routerLink]="[item.route]"
            >
              {{ item.name }}
            </button>

            <button mat-menu-item (click)="auth.singOut()">Cerrar sesión</button>
          </mat-menu>


        </div>

        <ng-template #unlogged>
          <ng-container *ngIf="loginMethod != 'link'; else emailMethod">
            <mx-login-button
            (isLogged)="user = $event"
            [method]="loginMethod"
            [accountAdvertice]="false"
            [signOutLabel]="logoutLabel"
            ></mx-login-button>
          </ng-container>
          <ng-template #emailMethod>
            <a [routerLink]="[loginButtonLink]" mat-raised-button>{{loginButtonLabel}}</a>
          </ng-template>
        </ng-template>
      </div>


    </ng-container>
    <ng-template #mobile>
      <button mat-icon-button (click)="sidebar?.toggle()">
        <mat-icon>menu</mat-icon>
      </button>
    </ng-template>
    </mat-toolbar>

  </mat-drawer-content>
</mat-drawer-container>
